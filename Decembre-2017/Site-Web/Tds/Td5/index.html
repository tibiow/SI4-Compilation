<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="author" content="Erick Gallesio" />
    <meta name="robots" content="noindex, nofollow, noarchive" />
    <meta name="robots" content="none" />
    <meta name="generator" content="Gomd 2.0-alpha / Erick Gallesio" />
    
    
    <!-- W3css -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://www.w3schools.com/lib/w3.css">
    
    
    
    <!-- KaTeX -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.6.0/katex.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.6.0/katex.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.6.0/contrib/auto-render.min.js"></script>
    
    
    
    <!-- font-awesome -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
    
    
    <style type="text/css">
    <!-- 
         
         body.hl{background-color:#1f3055}code.hl{color:#b2dfee;background-color:#1f3055;font-size:10pt;font-family:courier new,monospace}.hl.num{color:#b3ee3a}.hl.esc{color:#ffeea6}.hl.str{color:#ccc}.hl.pps{color:#ccc}.hl.slc{color:#9e9e9e}.hl.com{color:#9e9e9e}.hl.ppc{color:#b2dfee}.hl.opt{color:#fff}.hl.ipl{color:#ceff9f}.hl.lin{color:#9e9e9e}.hl.kwa{color:#cd919e}.hl.kwb{color:#f40}.hl.kwc{color:#9ecc91}.hl.kwd{color:#edc1b2}  
         
         
         body{font-family:helvetica neue,helvetica,arial,sans-serif;color:#333}pre{margin:1em 0;padding:0;border:0}pre code{margin:0;border-radius:8px;padding:5px;display:block}code{padding:2px 4px;font-size:90%;color:#c7254e;background-color:#f9f2f4;border-radius:4px}blockquote{font-size:14px;font-style:oblique}ul{list-style-type:"- "}a{color:#337ab7;text-decoration:none}a:focus,a:hover{color:#23527c;text-decoration:underline}h2{border-bottom:3px solid #ccc}.page-header{padding:8px 0}.page-footer{background:#fafafa;padding:5px 10px 0;position:fixed;margin:0;bottom:0;left:0;width:1e2%}table{border-collapse:collapse}th{background:#ddd;padding:0 1em}td{padding:0 1em}table,td,th{border:1px solid #000}.center{text-align:center;margin:0 auto}@page{size:a4;@bottom-center{content:counter(page)"/"counter(pages);font-style:italic}}@media print{body{font-family:palatino linotype,book antiqua,palatino,serif;font-size:1em;margin:0;font-size:9pt;background-color:#fff!important;color:#000!important}h1,h2,h3,h4:{page-break-after:avoid}code{font-size:9pt;page-break-inside:avoid}p,li{orphans:2;widows:2}header,footer,.noprint{display:none}.print{width:1e2%}}  
         
         
      -->
    </style>
    
    <!-- ====================================================================== -->
    <title>Feuille 5: Implementation d'un mini-langage</title>
  </head>

  <body>
    <header>
      <div class="w3-container w3-bar w3-black page-header" style="font-size: 18px">
        <a class="w3-bar-item w3-button w3-hover-red w3-text-grey" href="../..//index.html">
          Compilation
        </a>

        
          
             <a class="w3bar-item w3-button w3-hover-red w3-text-grey" href="../../Tds/Td1/index.html">Td1</a>
          
             <a class="w3bar-item w3-button w3-hover-red w3-text-grey" href="../../Tds/Td2/index.html">Td2</a>
          
             <a class="w3bar-item w3-button w3-hover-red w3-text-grey" href="../../Tds/Td3/index.html">Td3</a>
          
             <a class="w3bar-item w3-button w3-hover-red w3-text-grey" href="../../Tds/Td4/index.html">Td4</a>
          
             <a class="w3bar-item w3-button w3-hover-red w3-text-grey" href="../../Tds/Td5/index.html">Td5</a>
          
             <a class="w3bar-item w3-button w3-hover-red w3-text-grey" href="../../Tds/Td6/index.html">Td6</a>
          
             <a class="w3bar-item w3-button w3-hover-red w3-text-grey" href="../../Tds/Td7/index.html">Td7</a>
          
             <a class="w3bar-item w3-button w3-hover-red w3-text-grey" href="../../Tds/Td8/index.html">Td8</a>
          
        
      </div>
    </header>


    <div class="w3-row-padding">

      <!-- Left margin -->
      <div class="w3-quarter noprint">
        <!-- Informations -->
        

        <ul class="w3-ul w3-card-2 w3-border" style="margin-top: 16px">
          <li class="w3-red">
            <i class="fa fa-info-circle"></i> &nbsp;&nbsp;<b>Informations</b></li>
          <li style="font-size: 12px;">
            <p><strong>Année 2017-2018</strong>:</p>

<p>- 21/09: Début du cours<br>
- 09/11: Contrôle intermédiaire<br>
- 21/12: Contôle final</p>

          </li>
        </ul>
        

        <!-- Resources -->
        
        <ul class="w3-ul w3-card-2 w3-border" style="margin-top: 16px">
          <li class="w3-indigo">
            <i class="fa fa-file"></i> &nbsp;&nbsp;<b>Ressources</b></li>
          <li style="font-size: 12px;">
            <p>- <a href="http://www.polytech.unice.fr/%7Eeg/Compilation/Ressources/flex.pdf">Doc. Flex</a><br/>
- <a href="http://www.polytech.unice.fr/%7Eeg/Compilation/Ressources/bison.pdf">Doc. Bison</a><br/></p>

          </li>
        </ul>
        
        
        <!-- Links -->
        
      </div>
        
      <div class="w3-threequarter print">
        
        <div class="w3-center" style="margin:32px 16px;">
          <h1>Feuille 5: Implementation d'un mini-langage</h1>
          <h2 style="border: 0px">Un frontend et trois backends</h2>
        </div>
<h2 id="sujet">Sujet</h2>

<p>Le sujet de la feuille de Td est <a href="sujet.html">ici</a>.</p>

<p>Pour réaliser ce TD, prendre l&#39;archive contenant le 
<a href="Skeleton.tar.gz">squellette de l&#39;implementation</a> demandée.</p>

<h2 id="corrigés">Corrigés</h2>

<blockquote>
<p>Seule Une partie des corrigés est donnée ici.</p>
</blockquote>

<h3 id="code-1">Code 1</h3>

<p>Le fichier <code>code1.c</code> permet de construire une calculatrice qui évalue
directement le résultat des expressions.</p>

<p>Si on exécute le programme <code>calc1</code>sur l&#39;entrée suivante:</p>

<pre><code class="hl c">    <span class="hl ppc"># Calcul de la factorielle de 12</span>
    <span class="hl opt">{</span>
      n <span class="hl opt">=</span> <span class="hl num">12</span><span class="hl opt">;</span>
      prod <span class="hl opt">=</span> <span class="hl num">1</span><span class="hl opt">;</span>
      <span class="hl kwa">while</span> <span class="hl opt">(</span>n <span class="hl opt">&gt;</span> <span class="hl num">1</span><span class="hl opt">) {</span>
          prod <span class="hl opt">=</span> prod <span class="hl opt">*</span> n<span class="hl opt">;</span>
          n <span class="hl opt">=</span> n <span class="hl opt">-</span> <span class="hl num">1</span><span class="hl opt">;</span>
      <span class="hl opt">}</span>
    
      <span class="hl ppc"># Valeur attendue: 479001600</span>
      print prod<span class="hl opt">;</span>
    <span class="hl opt">}</span>
</code></pre>

<p>On obtient en sortie: 
<code>4.79002e+08
    Bye.</code>
Ce qui est bien une approximation de 12! (479001600).</p>

<ul>
<li><a href="code1.c"><strong>Corrigé de code1.c <span class='fa fa-file-o'></span></strong></a></li>
<li>Noter que le fichier <code>code1.c</code> implémente la fonction <code>read</code> de la question 4.</li>
</ul>

<h3 id="code-2">Code 2</h3>

<p>Le fichier <code>code2.c</code> permet de construire générateur de code pour une
machine à pile.</p>

<p>Si on exécute le programme <code>calc2</code> sur le programme précédent (factorielle), on obtient:</p>

<pre><code class="hl">        push    12
        store   n
        push    1
        store   prod
L000:
        load    n
        push    1
        cmpgt
        jumpz   L001
        load    prod
        load    n
        mul
        store   prod
        load    n
        push    1
        sub
        store   n
        jump    L000
L001:
        load    prod
        print
</code></pre>

<p>Ce programme peut être évalué avec l&#39;interprète qui vous est fourni
dans le <code>Ressource/interp</code>. L&#39;évaluation de la séquence de code
précédente sur <code>interp</code> produit bien la valeur escomptée:
<code>479001600.0
    *stop*</code></p>

<p><strong>Les sources de ce programme seront donnés ultérieurement</strong></p>

<h3 id="code-3">Code 3</h3>

<p>Le fichier <code>code3.c</code> permet de construire générateur de code qui produit un 
fichier Graphviz au format <code>dot</code>.</p>

<p>Si on exécute le programme <code>calc3</code> sur le programme précédent (factorielle), on obtient:</p>

<pre><code class="hl dot"><span class="hl kwa">digraph</span> E{
	<span class="hl kwa">node</span> [<span class="hl kwb">style</span>=<span class="hl str">&quot;filled&quot;</span>]<span class="hl opt">;</span>
	box1 [<span class="hl kwb">label</span>=<span class="hl str">&quot;[;]&quot;</span><span class="hl opt">,</span> <span class="hl kwb">fillcolor</span>=<span class="hl str">&quot;turquoise4&quot;</span>]<span class="hl opt">;</span>
	box2 [<span class="hl kwb">label</span>=<span class="hl str">&quot;[;]&quot;</span><span class="hl opt">,</span> <span class="hl kwb">fillcolor</span>=<span class="hl str">&quot;turquoise4&quot;</span>]<span class="hl opt">;</span>
	box3 [<span class="hl kwb">label</span>=<span class="hl str">&quot;[;]&quot;</span><span class="hl opt">,</span> <span class="hl kwb">fillcolor</span>=<span class="hl str">&quot;turquoise4&quot;</span>]<span class="hl opt">;</span>
	box4 [<span class="hl kwb">label</span>=<span class="hl str">&quot;[=]&quot;</span><span class="hl opt">,</span> <span class="hl kwb">fillcolor</span>=<span class="hl str">&quot;turquoise4&quot;</span>]<span class="hl opt">;</span>
	box5 [<span class="hl kwb">label</span>=<span class="hl str">&quot;n&quot;</span><span class="hl opt">,</span> <span class="hl kwb">fillcolor</span>=<span class="hl str">&quot;peru&quot;</span>]<span class="hl opt">;</span>
		box4 <span class="hl opt">-&gt;</span> box5<span class="hl opt">;</span>
	box6 [<span class="hl kwb">label</span>=<span class="hl str">&quot;12&quot;</span><span class="hl opt">,</span> <span class="hl kwb">fillcolor</span>=<span class="hl str">&quot;tomato&quot;</span>]<span class="hl opt">;</span>
		box4 <span class="hl opt">-&gt;</span> box6<span class="hl opt">;</span>
		box3 <span class="hl opt">-&gt;</span> box4<span class="hl opt">;</span>
	box7 [<span class="hl kwb">label</span>=<span class="hl str">&quot;[=]&quot;</span><span class="hl opt">,</span> <span class="hl kwb">fillcolor</span>=<span class="hl str">&quot;turquoise4&quot;</span>]<span class="hl opt">;</span>
	box8 [<span class="hl kwb">label</span>=<span class="hl str">&quot;prod&quot;</span><span class="hl opt">,</span> <span class="hl kwb">fillcolor</span>=<span class="hl str">&quot;peru&quot;</span>]<span class="hl opt">;</span>
		box7 <span class="hl opt">-&gt;</span> box8<span class="hl opt">;</span>
	box9 [<span class="hl kwb">label</span>=<span class="hl str">&quot;1&quot;</span><span class="hl opt">,</span> <span class="hl kwb">fillcolor</span>=<span class="hl str">&quot;tomato&quot;</span>]<span class="hl opt">;</span>
		box7 <span class="hl opt">-&gt;</span> box9<span class="hl opt">;</span>
		box3 <span class="hl opt">-&gt;</span> box7<span class="hl opt">;</span>
		box2 <span class="hl opt">-&gt;</span> box3<span class="hl opt">;</span>
	box10 [<span class="hl kwb">label</span>=<span class="hl str">&quot;while&quot;</span><span class="hl opt">,</span> <span class="hl kwb">fillcolor</span>=<span class="hl str">&quot;turquoise4&quot;</span>]<span class="hl opt">;</span>
	box11 [<span class="hl kwb">label</span>=<span class="hl str">&quot;[&gt;]&quot;</span><span class="hl opt">,</span> <span class="hl kwb">fillcolor</span>=<span class="hl str">&quot;turquoise4&quot;</span>]<span class="hl opt">;</span>
	box12 [<span class="hl kwb">label</span>=<span class="hl str">&quot;n&quot;</span><span class="hl opt">,</span> <span class="hl kwb">fillcolor</span>=<span class="hl str">&quot;peru&quot;</span>]<span class="hl opt">;</span>
		box11 <span class="hl opt">-&gt;</span> box12<span class="hl opt">;</span>
	box13 [<span class="hl kwb">label</span>=<span class="hl str">&quot;1&quot;</span><span class="hl opt">,</span> <span class="hl kwb">fillcolor</span>=<span class="hl str">&quot;tomato&quot;</span>]<span class="hl opt">;</span>
		box11 <span class="hl opt">-&gt;</span> box13<span class="hl opt">;</span>
		box10 <span class="hl opt">-&gt;</span> box11<span class="hl opt">;</span>
	box14 [<span class="hl kwb">label</span>=<span class="hl str">&quot;[;]&quot;</span><span class="hl opt">,</span> <span class="hl kwb">fillcolor</span>=<span class="hl str">&quot;turquoise4&quot;</span>]<span class="hl opt">;</span>
	box15 [<span class="hl kwb">label</span>=<span class="hl str">&quot;[=]&quot;</span><span class="hl opt">,</span> <span class="hl kwb">fillcolor</span>=<span class="hl str">&quot;turquoise4&quot;</span>]<span class="hl opt">;</span>
	box16 [<span class="hl kwb">label</span>=<span class="hl str">&quot;prod&quot;</span><span class="hl opt">,</span> <span class="hl kwb">fillcolor</span>=<span class="hl str">&quot;peru&quot;</span>]<span class="hl opt">;</span>
		box15 <span class="hl opt">-&gt;</span> box16<span class="hl opt">;</span>
	box17 [<span class="hl kwb">label</span>=<span class="hl str">&quot;[*]&quot;</span><span class="hl opt">,</span> <span class="hl kwb">fillcolor</span>=<span class="hl str">&quot;turquoise4&quot;</span>]<span class="hl opt">;</span>
	box18 [<span class="hl kwb">label</span>=<span class="hl str">&quot;prod&quot;</span><span class="hl opt">,</span> <span class="hl kwb">fillcolor</span>=<span class="hl str">&quot;peru&quot;</span>]<span class="hl opt">;</span>
		box17 <span class="hl opt">-&gt;</span> box18<span class="hl opt">;</span>
	box19 [<span class="hl kwb">label</span>=<span class="hl str">&quot;n&quot;</span><span class="hl opt">,</span> <span class="hl kwb">fillcolor</span>=<span class="hl str">&quot;peru&quot;</span>]<span class="hl opt">;</span>
		box17 <span class="hl opt">-&gt;</span> box19<span class="hl opt">;</span>
		box15 <span class="hl opt">-&gt;</span> box17<span class="hl opt">;</span>
		box14 <span class="hl opt">-&gt;</span> box15<span class="hl opt">;</span>
	box20 [<span class="hl kwb">label</span>=<span class="hl str">&quot;[=]&quot;</span><span class="hl opt">,</span> <span class="hl kwb">fillcolor</span>=<span class="hl str">&quot;turquoise4&quot;</span>]<span class="hl opt">;</span>
	box21 [<span class="hl kwb">label</span>=<span class="hl str">&quot;n&quot;</span><span class="hl opt">,</span> <span class="hl kwb">fillcolor</span>=<span class="hl str">&quot;peru&quot;</span>]<span class="hl opt">;</span>
		box20 <span class="hl opt">-&gt;</span> box21<span class="hl opt">;</span>
	box22 [<span class="hl kwb">label</span>=<span class="hl str">&quot;[-]&quot;</span><span class="hl opt">,</span> <span class="hl kwb">fillcolor</span>=<span class="hl str">&quot;turquoise4&quot;</span>]<span class="hl opt">;</span>
	box23 [<span class="hl kwb">label</span>=<span class="hl str">&quot;n&quot;</span><span class="hl opt">,</span> <span class="hl kwb">fillcolor</span>=<span class="hl str">&quot;peru&quot;</span>]<span class="hl opt">;</span>
		box22 <span class="hl opt">-&gt;</span> box23<span class="hl opt">;</span>
	box24 [<span class="hl kwb">label</span>=<span class="hl str">&quot;1&quot;</span><span class="hl opt">,</span> <span class="hl kwb">fillcolor</span>=<span class="hl str">&quot;tomato&quot;</span>]<span class="hl opt">;</span>
		box22 <span class="hl opt">-&gt;</span> box24<span class="hl opt">;</span>
		box20 <span class="hl opt">-&gt;</span> box22<span class="hl opt">;</span>
		box14 <span class="hl opt">-&gt;</span> box20<span class="hl opt">;</span>
		box10 <span class="hl opt">-&gt;</span> box14<span class="hl opt">;</span>
		box2 <span class="hl opt">-&gt;</span> box10<span class="hl opt">;</span>
		box1 <span class="hl opt">-&gt;</span> box2<span class="hl opt">;</span>
	box25 [<span class="hl kwb">label</span>=<span class="hl str">&quot;print&quot;</span><span class="hl opt">,</span> <span class="hl kwb">fillcolor</span>=<span class="hl str">&quot;turquoise4&quot;</span>]<span class="hl opt">;</span>
	box26 [<span class="hl kwb">label</span>=<span class="hl str">&quot;prod&quot;</span><span class="hl opt">,</span> <span class="hl kwb">fillcolor</span>=<span class="hl str">&quot;peru&quot;</span>]<span class="hl opt">;</span>
		box25 <span class="hl opt">-&gt;</span> box26<span class="hl opt">;</span>
		box1 <span class="hl opt">-&gt;</span> box25<span class="hl opt">;</span>
}
</code></pre>

<p>Ce fichier correspond au graphe suivant:</p>

<p><center>
<img src="fact.png" width="80%">
<br/><br/><emph>Le programme factorielle</emph>
</center></p>

<p><strong>Les sources de ce programme seront donnés ultérieurement</strong></p>

<h3 id="primitive-read">Primitive read</h3>

<p><strong>Pas de corrigé</strong>.</p>
      </div>
    </div>

    <footer> 
      <div class="w3-container"> &nbsp;</div>
      <div class="page-footer">
        <small> 
          <b>Compilation</b> — Erick Gallesio
          <span class="pull-right">11-Dec-2017 19:29 (eg)</span>
        </small>
      </div>
    </footer>
    

    
    <!--Maths -->
    <script>
      renderMathInElement(document.body);
    </script>
    

  </body>
</html>
